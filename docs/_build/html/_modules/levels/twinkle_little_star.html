<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>levels.twinkle_little_star &mdash; Guitar-Champions 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=8d563738"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Guitar-Champions
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">guitar_champions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Guitar-Champions</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">levels.twinkle_little_star</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for levels.twinkle_little_star</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file controls our twinkle little star level. It contains all information for this level to run including audio detection and filtering, </span>
<span class="sd">notes to be played, animations for this level, background generation, pause menu, and main loop to keep the level running.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># import pygame asprite package, download by typing &quot;pip3 install pygame_aseprite_animation&quot; into your terminal</span>
<span class="kn">from</span> <span class="nn">pygame_aseprite_animation</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># Import the pygame module</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="c1"># Import random for random numbers</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pyaudio</span>
<span class="kn">import</span> <span class="nn">wave</span>
<span class="kn">import</span> <span class="nn">librosa</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">find_peaks</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>


<span class="kn">import</span> <span class="nn">crepe</span>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">import</span> <span class="nn">keras.backend</span> <span class="k">as</span> <span class="nn">K</span>
<span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="n">note</span> <span class="k">as</span> <span class="n">music21Note</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_VISIBLE_DEVICS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-1&#39;</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="c1"># Import the menu library to more easily make menu selction</span>
<span class="kn">import</span> <span class="nn">pygame_menu</span>
 
<span class="c1"># Import pygame.locals for easier access to key coordinates</span>
<span class="c1"># Updated to conform to flake8 and black standards</span>
<span class="c1"># from pygame.locals import *</span>
<span class="kn">from</span> <span class="nn">pygame.locals</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">RLEACCEL</span><span class="p">,</span>
    <span class="n">K_ESCAPE</span><span class="p">,</span>
    <span class="n">KEYDOWN</span><span class="p">,</span>
    <span class="n">QUIT</span><span class="p">,</span>
    <span class="n">K_SPACE</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">partials.player.playing_player</span> <span class="k">as</span> <span class="nn">playing_player</span>
<span class="kn">import</span> <span class="nn">partials.notes.text_note</span> <span class="k">as</span> <span class="nn">note</span>
<span class="kn">import</span> <span class="nn">partials.buttons.text_button</span> <span class="k">as</span> <span class="nn">text_button</span>

<span class="kn">import</span> <span class="nn">helpers.settings_helper</span> <span class="k">as</span> <span class="nn">settings_helper</span>

<span class="kn">import</span> <span class="nn">partials.titlecard.title_card</span> <span class="k">as</span> <span class="nn">title_card</span>


<span class="n">main_midi_number_arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>

<div class="viewcode-block" id="start">
<a class="viewcode-back" href="../../levels.html#levels.twinkle_little_star.start">[docs]</a>
<span class="k">def</span> <span class="nf">start</span><span class="p">():</span>


    <span class="n">user_settings</span> <span class="o">=</span> <span class="n">settings_helper</span><span class="o">.</span><span class="n">get_settings</span><span class="p">()</span>

    <span class="c1"># Define constants for the screen width and height</span>
    <span class="n">SCREEN_WIDTH</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">get_surface</span><span class="p">()</span><span class="o">.</span><span class="n">get_size</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">SCREEN_HEIGHT</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">get_surface</span><span class="p">()</span><span class="o">.</span><span class="n">get_size</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">PLAY_LINE_LOCATION</span> <span class="o">=</span> <span class="mi">290</span>

    <span class="c1"># Variable to keep our main loop running</span>
    <span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">paused</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">completed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">restart_level</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">pauserendered</span><span class="o">=</span><span class="kc">False</span>

    <span class="n">created_end_graph</span> <span class="o">=</span> <span class="kc">False</span>


    <span class="c1"># Setup for sounds, defaults are good</span>
    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

    <span class="c1"># Initialize pygame</span>
    <span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

    <span class="c1"># Create the screen object</span>
    <span class="c1"># The size is determined by the constant SCREEN_WIDTH and SCREEN_HEIGHT</span>
    <span class="n">screen</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span><span class="p">))</span>

    <span class="c1"># set aseprite file directory</span>
    <span class="n">aseprite_file_directory</span> <span class="o">=</span> <span class="s1">&#39;assets/animations/starTWINKLE.aseprite&#39;</span>
    <span class="n">aseprite_file_directory2</span> <span class="o">=</span> <span class="s1">&#39;assets/animations/starTWINKLE2.aseprite&#39;</span>

    <span class="c1"># initialize animations - To add new animations, create a new animationmanager the same way its created here and put the Animation in its list</span>
    <span class="c1"># star animations</span>
    <span class="n">star1</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">(</span><span class="n">aseprite_file_directory</span><span class="p">)</span>
    <span class="n">animationmanager</span> <span class="o">=</span> <span class="n">AnimationManager</span><span class="p">([</span><span class="n">star1</span><span class="p">],</span> <span class="n">screen</span><span class="p">)</span>
    <span class="n">star2</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">(</span><span class="n">aseprite_file_directory</span><span class="p">)</span>
    <span class="n">animationmanager2</span> <span class="o">=</span> <span class="n">AnimationManager</span><span class="p">([</span><span class="n">star2</span><span class="p">],</span> <span class="n">screen</span><span class="p">)</span>
    <span class="n">star3</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">(</span><span class="n">aseprite_file_directory</span><span class="p">)</span>
    <span class="n">animationmanager3</span> <span class="o">=</span> <span class="n">AnimationManager</span><span class="p">([</span><span class="n">star3</span><span class="p">],</span> <span class="n">screen</span><span class="p">)</span>
    <span class="n">starL1</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">(</span><span class="n">aseprite_file_directory2</span><span class="p">)</span>
    <span class="n">animationmanager5</span> <span class="o">=</span> <span class="n">AnimationManager</span><span class="p">([</span><span class="n">starL1</span><span class="p">],</span> <span class="n">screen</span><span class="p">)</span>
    <span class="n">starL2</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">(</span><span class="n">aseprite_file_directory2</span><span class="p">)</span>
    <span class="n">animationmanager6</span> <span class="o">=</span> <span class="n">AnimationManager</span><span class="p">([</span><span class="n">starL2</span><span class="p">],</span> <span class="n">screen</span><span class="p">)</span>
    <span class="n">starL3</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">(</span><span class="n">aseprite_file_directory2</span><span class="p">)</span>
    <span class="n">animationmanager7</span> <span class="o">=</span> <span class="n">AnimationManager</span><span class="p">([</span><span class="n">starL3</span><span class="p">],</span> <span class="n">screen</span><span class="p">)</span>

    <span class="c1"># flying saucer animations</span>
    <span class="n">flyingSaucer</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">(</span><span class="s1">&#39;assets/animations/flyingsaucerSPIN.aseprite&#39;</span><span class="p">)</span>
    <span class="n">animationmanager4</span> <span class="o">=</span> <span class="n">AnimationManager</span><span class="p">([</span><span class="n">flyingSaucer</span><span class="p">],</span> <span class="n">screen</span><span class="p">)</span>
    

    <span class="c1"># Setup the clock for a decent framerate</span>
    <span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>

    <span class="c1"># this keeps track of how many frames have occured since the last note was sent out</span>
    <span class="c1"># it is used later for keeping the notes sending at a regular rate</span>
    <span class="n">frames_since_note</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Keeps track of the number of frames since the metronome was last played</span>
    <span class="n">frames_since_metronome</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">user_settings</span><span class="o">.</span><span class="n">enable_metronome</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># Load and play our background music</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;assets/sounds/background-music/metro-34-60bpm.mp3&quot;</span><span class="p">)</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="n">user_settings</span><span class="o">.</span><span class="n">volume</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>


    <span class="c1"># Create our &#39;player&#39;</span>
    <span class="c1">#player = playing_player.Player(top_padding=390)</span>

    

    <span class="c1"># Create groups to hold Note sprites, and all sprites</span>
    <span class="c1"># - Notes is used for position updates</span>
    <span class="c1"># - all_sprites isused for rendering</span>
    <span class="n">Notes</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
    <span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
    <span class="c1">#all_sprites.add(player)</span>


    <span class="c1"># Start Audio</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">pyaudio</span><span class="o">.</span><span class="n">PyAudio</span><span class="p">()</span>

    <span class="n">stream</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">pyaudio</span><span class="o">.</span><span class="n">paFloat32</span><span class="p">,</span>
                    <span class="n">channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">rate</span><span class="o">=</span><span class="mi">16000</span><span class="p">,</span>
                    <span class="nb">input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">frames_per_buffer</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span>
                    <span class="n">stream_callback</span><span class="o">=</span><span class="n">audio_callback</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Streaming and processing audio. Press Ctrl+C to stop.&quot;</span><span class="p">)</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">start_stream</span><span class="p">()</span>


    <span class="c1"># Create the background image for the level</span>
    <span class="n">bg_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/images/backgrounds/Little_Star_Background.jpg&#39;</span><span class="p">)</span>
    <span class="n">bg_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">bg_img</span><span class="p">,(</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span><span class="n">SCREEN_HEIGHT</span><span class="p">))</span>

    <span class="c1"># a foreground image for the notes to go behind</span>
    <span class="c1"># fg_image = pygame.image.load(&quot;assets/images/backgrounds/happy_birthday_foreground.png&quot;).convert()</span>
    <span class="c1"># fg_image.set_colorkey((255, 255, 255), RLEACCEL)</span>


    <span class="c1"># the background image of the tabs</span>
    <span class="n">tabs_image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;assets/images/backgrounds/tabs_outline.png&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
    <span class="n">tabs_image</span><span class="o">.</span><span class="n">set_colorkey</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">RLEACCEL</span><span class="p">)</span>

    <span class="c1"># the image of the line where the ntoes should be when played</span>
    <span class="n">play_line_image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;assets/images/backgrounds/play_line.png&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
    <span class="n">play_line_image</span><span class="o">.</span><span class="n">set_colorkey</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">RLEACCEL</span><span class="p">)</span>

    


    <span class="c1"># This is the background for the final screen</span>
    <span class="n">score_screen_background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/images/backgrounds/orange_background.jpg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
    <span class="n">score_screen_background</span><span class="o">.</span><span class="n">set_colorkey</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">RLEACCEL</span><span class="p">)</span>

    <span class="n">end_screen_cheems</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/images/characters/npcs/birthday_dog.png&#39;</span><span class="p">)</span>

    <span class="n">completed_restart_level_button</span> <span class="o">=</span> <span class="n">text_button</span><span class="o">.</span><span class="n">TextButton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot; Restart Level &quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">151</span><span class="p">,</span><span class="n">height</span><span class="o">=</span> <span class="mi">44</span><span class="p">,</span> <span class="n">left_padding</span><span class="o">=</span> <span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">175</span><span class="p">,</span> <span class="n">top_padding</span><span class="o">=</span> <span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span>

    <span class="n">complete_level_button</span> <span class="o">=</span> <span class="n">text_button</span><span class="o">.</span><span class="n">TextButton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot; Return to Menu &quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">177</span><span class="p">,</span><span class="n">height</span><span class="o">=</span> <span class="mi">44</span><span class="p">,</span> <span class="n">left_padding</span><span class="o">=</span> <span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">163</span><span class="p">,</span> <span class="n">top_padding</span><span class="o">=</span> <span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">140</span><span class="p">)</span>

    

    <span class="c1"># This is the transparent background for the pause menu</span>
    <span class="n">transparent_surface</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="mi">60</span><span class="p">),</span> <span class="n">pygame</span><span class="o">.</span><span class="n">SRCALPHA</span><span class="p">)</span>
    <span class="n">transparent_surface</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">transparent_surface</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    
    <span class="n">pause_title</span> <span class="o">=</span> <span class="n">title_card</span><span class="o">.</span><span class="n">Titlecard</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;   Paused   &quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">350</span><span class="p">,</span><span class="n">height</span><span class="o">=</span> <span class="mi">59</span><span class="p">,</span> <span class="n">left_padding</span><span class="o">=</span> <span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">175</span><span class="p">,</span> <span class="n">top_padding</span><span class="o">=</span> <span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span>
    
    <span class="c1"># These are the buttons for the pause menu</span>
    <span class="n">resume_button</span> <span class="o">=</span> <span class="n">text_button</span><span class="o">.</span><span class="n">TextButton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot; Resume &quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">96</span><span class="p">,</span><span class="n">height</span><span class="o">=</span> <span class="mi">44</span><span class="p">,</span> <span class="n">left_padding</span><span class="o">=</span> <span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">top_padding</span><span class="o">=</span> <span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">80</span><span class="p">)</span>
    <span class="n">restart_button</span> <span class="o">=</span> <span class="n">text_button</span><span class="o">.</span><span class="n">TextButton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot; Restart &quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">94</span><span class="p">,</span><span class="n">height</span><span class="o">=</span> <span class="mi">44</span><span class="p">,</span> <span class="n">left_padding</span><span class="o">=</span> <span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">48</span><span class="p">,</span> <span class="n">top_padding</span><span class="o">=</span> <span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">main_menu_button</span> <span class="o">=</span> <span class="n">text_button</span><span class="o">.</span><span class="n">TextButton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot; Main Menu &quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">128</span><span class="p">,</span><span class="n">height</span><span class="o">=</span> <span class="mi">44</span><span class="p">,</span> <span class="n">left_padding</span><span class="o">=</span> <span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">62</span><span class="p">,</span> <span class="n">top_padding</span><span class="o">=</span> <span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span><span class="mi">60</span><span class="p">)</span>
    <span class="n">quit_button</span> <span class="o">=</span> <span class="n">text_button</span><span class="o">.</span><span class="n">TextButton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot; Quit &quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">60</span><span class="p">,</span><span class="n">height</span><span class="o">=</span> <span class="mi">44</span><span class="p">,</span> <span class="n">left_padding</span><span class="o">=</span> <span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">top_padding</span><span class="o">=</span> <span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">120</span><span class="p">)</span>



    <span class="c1"># Variables to keep track of the notes of the song</span>
    <span class="n">note_index</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># this is a multiplier that is used to figure out how many beats later the next note should come</span>
    <span class="c1"># after each note is created this is dynamically updated by calling a function on that note</span>
    <span class="c1"># 1.0 means that the next note plays one beat later, 2.0 is 2 beats later while 0.5 would be half a beat later</span>
    <span class="n">time_to_next_note</span> <span class="o">=</span> <span class="mf">1.0</span>
 

    <span class="c1"># This is the array with the song&#39;s note information</span>
    <span class="n">song_notes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">69</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">69</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>

        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">9</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">11</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">13</span><span class="p">),</span>

        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">14</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">16</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">17</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">18</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">19</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>

        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">21</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">22</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">23</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">24</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">27</span><span class="p">),</span>

        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">28</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">29</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">31</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">69</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">32</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">69</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">33</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">67</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">34</span><span class="p">),</span>

        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">28</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">29</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">31</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">32</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">33</span><span class="p">),</span>
        <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">midi</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">time_to_next_note</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">tab_line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Screen_Width</span><span class="o">=</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">Screen_Height</span><span class="o">=</span><span class="n">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">34</span><span class="p">),</span>
        <span class="p">]</span>
    
    <span class="c1"># This keeps track of all the notes the player correctly hit</span>
    <span class="c1"># It is used for scoring at the end of the game</span>
    <span class="n">correctly_played_notes</span> <span class="o">=</span> <span class="p">[]</span>
    

    <span class="c1"># Our main loop</span>
    <span class="k">while</span> <span class="n">running</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">completed</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1">#    What should display if the game is over</span>
            <span class="c1"># Game over control loop</span>
            
            <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>



            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>

                    <span class="c1"># Did the user hit a key?</span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">KEYDOWN</span><span class="p">:</span>

                        <span class="c1"># Was it the Escape key? If so, stop the loop</span>
                        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">K_ESCAPE</span>  <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">K_SPACE</span><span class="p">:</span>
                            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>

                    <span class="c1"># Did the user click the window close button? If so, exit</span>
                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">QUIT</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                    <span class="c1"># Here we check for hover events </span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="n">pygame</span><span class="o">.</span><span class="n">MOUSEMOTION</span><span class="p">:</span>
                        <span class="n">complete_level_button</span><span class="o">.</span><span class="n">on_hover</span><span class="p">()</span>
                        <span class="n">completed_restart_level_button</span><span class="o">.</span><span class="n">on_hover</span><span class="p">()</span>
                        

                    <span class="c1"># Here we check for clicks events </span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="n">pygame</span><span class="o">.</span><span class="n">MOUSEBUTTONDOWN</span><span class="p">:</span>

                        <span class="c1"># text_buttons should be pressed like this</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">complete_level_button</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
                        
                        <span class="k">if</span> <span class="p">(</span><span class="n">completed_restart_level_button</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                            <span class="c1"># this will exit the main loop, setting the condition to restart the level as true</span>
                            <span class="n">restart_level</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">created_end_graph</span> <span class="o">=</span> <span class="kc">False</span>


            
            <span class="c1"># calculates the total of the notes that were correctly played</span>
            <span class="n">total_score</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">correctly_played_notes</span><span class="p">)</span>
            <span class="c1"># create an array that stores accuracy percentage at each note</span>
            <span class="n">accuracy_array</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">index_array</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">correcters</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">totnote</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">noe</span> <span class="ow">in</span> <span class="n">song_notes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">noe</span><span class="o">.</span><span class="n">was_played</span><span class="p">:</span>
                    <span class="n">correcters</span><span class="o">+=</span><span class="mi">1</span>
                <span class="n">totnote</span><span class="o">+=</span><span class="mi">1</span>
                <span class="n">index_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">totnote</span><span class="p">)</span>
                <span class="n">accuracy_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">correcters</span><span class="o">/</span><span class="n">totnote</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">created_end_graph</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                <span class="c1"># You only create the graph if it hasn&#39;t already been created for this ending</span>
                <span class="n">create_graph</span><span class="p">(</span><span class="n">index_array</span><span class="p">,</span> <span class="n">accuracy_array</span><span class="p">,</span> <span class="n">totnote</span><span class="p">)</span>
                <span class="n">created_end_graph</span> <span class="o">=</span> <span class="kc">True</span>


            <span class="n">endplot</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/images/tempgraphs/graphy.png&#39;</span><span class="p">)</span>
            <span class="c1"># create a font to select font and size</span>
            <span class="n">score_font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="s1">&#39;assets/font/BITSUMIS.ttf&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
            <span class="n">end_font</span><span class="o">=</span>  <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="s1">&#39;assets/font/Signatra.ttf&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
            <span class="c1"># create a text surface object using the font</span>
            <span class="c1"># on which text is drawn on it.</span>
            <span class="n">end_text</span><span class="o">=</span> <span class="s2">&quot; Level  Complete! &quot;</span>
            <span class="n">end_render</span> <span class="o">=</span> <span class="n">end_font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">end_text</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="p">(</span><span class="mi">239</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
            <span class="n">score_font_text</span> <span class="o">=</span> <span class="s2">&quot; You correctly played: &quot;</span> 
            <span class="n">score_font_text2</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">total_score</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot; out of &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">song_notes</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;! &quot;</span>
            <span class="n">score_font_render</span> <span class="o">=</span> <span class="n">score_font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">score_font_text</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="p">(</span><span class="mi">239</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
            <span class="n">score_font_render2</span> <span class="o">=</span> <span class="n">score_font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">score_font_text2</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="p">(</span><span class="mi">239</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>

            

            <span class="c1"># This is calculates the player&#39;s percentage score</span>
            <span class="n">percent_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_score</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">song_notes</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

            <span class="c1"># this is the encouragement that shows up depending on their score</span>
            <span class="n">encouragement_font_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="c1"># this determines your encouragement method</span>
            <span class="k">if</span> <span class="n">percent_score</span> <span class="o">==</span> <span class="mf">100.0</span><span class="p">:</span>
                <span class="n">encouragement_font_text</span> <span class="o">=</span> <span class="s2">&quot; Perfect! &quot;</span>
            <span class="k">elif</span> <span class="n">percent_score</span> <span class="o">&gt;=</span> <span class="mf">66.666</span><span class="p">:</span>
                <span class="n">encouragement_font_text</span> <span class="o">=</span> <span class="s2">&quot; Well done! &quot;</span>
            <span class="k">elif</span> <span class="n">percent_score</span> <span class="o">&gt;=</span> <span class="mf">33.333</span><span class="p">:</span>
                <span class="n">encouragement_font_text</span> <span class="o">=</span> <span class="s2">&quot; Good try! &quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">encouragement_font_text</span> <span class="o">=</span> <span class="s2">&quot; You can do it! &quot;</span>


            <span class="n">encouragement_font_render</span> <span class="o">=</span> <span class="n">score_font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">encouragement_font_text</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="p">(</span><span class="mi">239</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>

            <span class="c1"># screen = pygame.display.set_mode((1200, 900))</span>

            <span class="c1"># displays the visual elements of the completed screen</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">score_screen_background</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="o">*</span><span class="mf">.6</span><span class="p">,</span><span class="mf">.9</span><span class="o">*</span><span class="n">SCREEN_HEIGHT</span><span class="p">))</span> 
            <span class="n">s</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">160</span><span class="p">)</span>                
            <span class="n">s</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>           
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
            <span class="n">end_screen_cheems</span><span class="o">=</span><span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">end_screen_cheems</span><span class="p">,(</span><span class="mi">270</span><span class="p">,</span><span class="mi">270</span><span class="p">))</span>
            <span class="n">endplot</span><span class="o">=</span><span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">endplot</span><span class="p">,(</span><span class="mi">440</span><span class="p">,</span><span class="mi">247</span><span class="p">))</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">end_screen_cheems</span><span class="p">,(</span><span class="n">SCREEN_WIDTH</span><span class="o">-</span><span class="mi">290</span><span class="p">,</span><span class="mi">40</span><span class="p">))</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">endplot</span><span class="p">,(</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">360</span><span class="p">,</span><span class="mi">300</span><span class="p">))</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">score_font_render</span><span class="p">,</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="mi">162</span><span class="p">,</span><span class="mi">150</span><span class="p">))</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">score_font_render2</span><span class="p">,</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">end_render</span><span class="p">,</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="mi">130</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="mi">130</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">373</span><span class="p">,</span><span class="mi">85</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">encouragement_font_render</span><span class="p">,</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="mi">250</span><span class="p">))</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">completed_restart_level_button</span><span class="o">.</span><span class="n">render</span><span class="p">,</span> <span class="n">completed_restart_level_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">)</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">completed_restart_level_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">complete_level_button</span><span class="o">.</span><span class="n">render</span><span class="p">,</span> <span class="n">complete_level_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">)</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">complete_level_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            
            

            
            <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="n">clock</span><span class="o">.</span><span class="n">tick_busy_loop</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If we have started going through the notes and deleted the last one then the song is complete</span>
            <span class="k">if</span> <span class="n">note_index</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">song_notes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Notes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">completed</span> <span class="o">=</span> <span class="kc">True</span>


            <span class="k">if</span> <span class="n">paused</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="c1"># The control loop for when the game is paused</span>

                <span class="c1"># pauses the game music</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">pause</span><span class="p">()</span>

                <span class="c1"># cycles through every event and deals with them</span>
                <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>

                    <span class="c1"># Did the user hit a key?</span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">KEYDOWN</span><span class="p">:</span>

                        <span class="c1"># Was it the Escape key? If so, stop the loop</span>
                        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">K_ESCAPE</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">K_SPACE</span><span class="p">:</span>
                            <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">unpause</span><span class="p">()</span>
                            <span class="n">paused</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">pauserendered</span><span class="o">=</span><span class="kc">False</span>

                    <span class="c1"># Did the user click the window close button? If so, exit</span>
                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">QUIT</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                    <span class="c1"># Here we check for hover events </span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="n">pygame</span><span class="o">.</span><span class="n">MOUSEMOTION</span><span class="p">:</span>
                        <span class="n">resume_button</span><span class="o">.</span><span class="n">on_hover</span><span class="p">()</span>
                        <span class="n">restart_button</span><span class="o">.</span><span class="n">on_hover</span><span class="p">()</span>
                        <span class="n">main_menu_button</span><span class="o">.</span><span class="n">on_hover</span><span class="p">()</span>
                        <span class="n">quit_button</span><span class="o">.</span><span class="n">on_hover</span><span class="p">()</span>

                    <span class="c1"># Here we check for clicks events </span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="n">pygame</span><span class="o">.</span><span class="n">MOUSEBUTTONDOWN</span><span class="p">:</span>

                        <span class="c1"># text_buttons should be pressed like this</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">resume_button</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                            <span class="n">paused</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">unpause</span><span class="p">()</span>

                        <span class="k">elif</span><span class="p">(</span><span class="n">restart_button</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                            <span class="n">restart_level</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">created_end_graph</span> <span class="o">=</span> <span class="kc">False</span>

                        <span class="k">elif</span><span class="p">(</span><span class="n">main_menu_button</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                            <span class="n">restart_level</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
                            

                        <span class="k">elif</span><span class="p">(</span><span class="n">quit_button</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="c1">#checks if pausemenu has been rendered once before and if not, draws the transparent background</span>
                <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">pauserendered</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span> 
                    <span class="n">s</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">140</span><span class="p">)</span>                
                    <span class="n">s</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">239</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>           
                    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span>
                    <span class="n">pauserendered</span><span class="o">=</span><span class="kc">True</span>

                <span class="c1">#border around entire pause menu</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span><span class="n">SCREEN_WIDTH</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">SCREEN_HEIGHT</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span>  

                <span class="c1"># This visually updates the buttons on the pause screen and draws borders around them on render</span>
                <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">pause_title</span><span class="o">.</span><span class="n">render</span><span class="p">,</span> <span class="n">pause_title</span><span class="o">.</span><span class="n">button_position</span><span class="p">)</span>  
                <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">pause_title</span><span class="o">.</span><span class="n">button_position</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>  

                <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">resume_button</span><span class="o">.</span><span class="n">render</span><span class="p">,</span> <span class="n">resume_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">)</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">resume_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">restart_button</span><span class="o">.</span><span class="n">render</span><span class="p">,</span> <span class="n">restart_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">)</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">restart_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">main_menu_button</span><span class="o">.</span><span class="n">render</span><span class="p">,</span> <span class="n">main_menu_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">)</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">main_menu_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                
                <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">quit_button</span><span class="o">.</span><span class="n">render</span><span class="p">,</span> <span class="n">quit_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">)</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">quit_button</span><span class="o">.</span><span class="n">button_position</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="n">clock</span><span class="o">.</span><span class="n">tick_busy_loop</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>

    

            <span class="k">else</span><span class="p">:</span>


                <span class="k">for</span> <span class="n">curr_note</span> <span class="ow">in</span> <span class="n">Notes</span><span class="p">:</span>
                    <span class="c1"># This loops through all the notes on screen</span>
                    <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="n">PLAY_LINE_LOCATION</span><span class="o">-</span><span class="mi">200</span><span class="p">)</span> <span class="o">-</span> <span class="n">curr_note</span><span class="o">.</span><span class="n">get_x_location</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>

                        <span class="c1"># This triggers if the note is the one on screen</span>
                        <span class="c1"># This is a function from the note that we check to see if it&#39;s key was the one pressed</span>
                        <span class="c1"># print(&quot;MIDI Number: &quot;,main_midi_number)</span>
                        <span class="k">if</span> <span class="n">curr_note</span><span class="o">.</span><span class="n">check_correct_note</span><span class="p">(</span><span class="n">main_midi_number_arr</span><span class="p">):</span>
                            <span class="n">curr_note</span><span class="o">.</span><span class="n">was_played</span><span class="o">=</span><span class="kc">True</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Correct note played&quot;</span><span class="p">)</span>
                            <span class="n">correctly_played_notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_note</span><span class="p">)</span>
                            
                        <span class="c1">#else:</span>

                            <span class="c1"># If a key was pressed on time but was incorrect</span>
                            <span class="c1">#print(&quot;Incorrect note played&quot;)9</span>


                <span class="c1"># Look at every event in the queue</span>
                <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>

                    <span class="c1"># Did the user hit a key?</span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">KEYDOWN</span><span class="p">:</span>
                        
                        <span class="c1"># Was it the Escape key? If so, pause the loop</span>
                        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">K_ESCAPE</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">K_SPACE</span><span class="p">:</span>
                            <span class="n">paused</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">pauserendered</span><span class="o">=</span><span class="kc">False</span>

                    

                    <span class="c1"># Did the user click the window close button? If so, exit</span>
                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">QUIT</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


                <span class="k">for</span> <span class="n">curr_note</span> <span class="ow">in</span> <span class="n">Notes</span><span class="p">:</span>
                                <span class="c1"># This loops through all the notes on screen</span>

                                
                                

                                <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">PLAY_LINE_LOCATION</span> <span class="o">-</span> <span class="n">curr_note</span><span class="o">.</span><span class="n">get_x_location</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">)</span> <span class="p">:</span>
                                    <span class="c1"># it checks to see if the note is close enough to the play line to update</span>
                                    
                                    

                                    <span class="k">if</span> <span class="n">curr_note</span><span class="o">.</span><span class="n">get_is_active</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                                        <span class="c1"># if the note is currently note active</span>
                                        <span class="n">curr_note</span><span class="o">.</span><span class="n">set_active_color</span><span class="p">()</span>


                                <span class="k">else</span><span class="p">:</span>
                                     <span class="k">if</span> <span class="n">curr_note</span><span class="o">.</span><span class="n">get_is_active</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                                        <span class="c1"># if it is leaving the play line region</span>

                                        <span class="k">if</span><span class="p">((</span><span class="n">curr_note</span><span class="o">.</span><span class="n">get_x_location</span><span class="p">()</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">PLAY_LINE_LOCATION</span> <span class="o">-</span> <span class="mi">200</span><span class="p">))):</span>

                                            <span class="k">if</span> <span class="n">curr_note</span><span class="o">.</span><span class="n">get_was_played</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                                                <span class="c1"># if note was played successfully</span>
                                                <span class="n">curr_note</span><span class="o">.</span><span class="n">set_played_color</span><span class="p">()</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="c1"># if the note was not played successfully</span>
                                                <span class="n">curr_note</span><span class="o">.</span><span class="n">set_missed_color</span><span class="p">()</span>
                                    

                

                <span class="c1"># This adds notes every second</span>
                <span class="c1"># This uses the current fps so that you are adding notes accurately</span>
                <span class="k">if</span> <span class="n">frames_since_note</span> <span class="o">&gt;=</span> <span class="p">((</span><span class="n">clock</span><span class="o">.</span><span class="n">get_fps</span><span class="p">()</span> <span class="o">*</span> <span class="n">time_to_next_note</span> <span class="p">)</span><span class="o">//</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">clock</span><span class="o">.</span><span class="n">get_fps</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">):</span>
                        <span class="n">frames_since_note</span> <span class="o">=</span> <span class="mi">0</span>
                        

                        <span class="c1"># Create the new Note, and add it to our sprite groups</span>
                        <span class="k">if</span> <span class="n">note_index</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">song_notes</span><span class="p">)):</span>

                            <span class="n">new_Note</span> <span class="o">=</span> <span class="n">song_notes</span><span class="p">[</span><span class="n">note_index</span><span class="p">]</span>
                            <span class="n">note_index</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">Notes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_Note</span><span class="p">)</span>

                            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_Note</span><span class="p">)</span>

                            <span class="c1"># global time_to_next_note</span>
                            <span class="n">time_to_next_note</span> <span class="o">=</span> <span class="n">new_Note</span><span class="o">.</span><span class="n">get_time_to_next_note</span><span class="p">()</span>
                       
                <span class="n">frames_since_note</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Get the set of keys pressed and check for user input</span>
                <span class="n">pressed_keys</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()</span>
                <span class="c1">#player.update(pressed_keys)</span>


                <span class="c1"># Update the position of our Notes</span>
                <span class="n">Notes</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>




                <span class="c1"># Fill the screen with the background image</span>
                <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">bg_img</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">play_line_image</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
                <span class="c1">#screen.blit(fg_image, (0,0))</span>
                <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">tabs_image</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>


                <span class="c1"># Draw all our sprites</span>
                <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">all_sprites</span><span class="p">:</span>
                    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">surf</span><span class="p">,</span> <span class="n">entity</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
                
                <span class="c1"># star animations</span>
                <span class="n">animationmanager</span><span class="o">.</span><span class="n">update_self</span><span class="p">(</span><span class="mi">620</span><span class="p">,</span> <span class="mi">210</span><span class="p">)</span> 
                <span class="n">animationmanager2</span><span class="o">.</span><span class="n">update_self</span><span class="p">(</span><span class="mi">324</span><span class="p">,</span> <span class="mi">456</span><span class="p">)</span>
                <span class="n">animationmanager3</span><span class="o">.</span><span class="n">update_self</span><span class="p">(</span><span class="mi">465</span><span class="p">,</span> <span class="mi">430</span><span class="p">)</span>
                <span class="n">animationmanager5</span><span class="o">.</span><span class="n">update_self</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">222</span><span class="p">)</span>
                <span class="n">animationmanager6</span><span class="o">.</span><span class="n">update_self</span><span class="p">(</span><span class="mi">73</span><span class="p">,</span> <span class="mi">152</span><span class="p">)</span>
                <span class="n">animationmanager7</span><span class="o">.</span><span class="n">update_self</span><span class="p">(</span><span class="mi">532</span><span class="p">,</span> <span class="mi">138</span><span class="p">)</span>

                <span class="c1"># flying saucer animations</span>
                <span class="n">animationmanager4</span><span class="o">.</span><span class="n">update_self</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

                <span class="c1"># Flip everything to the display</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>

                <span class="c1"># Ensure we maintain a 30 frames per second rate</span>
                <span class="n">clock</span><span class="o">.</span><span class="n">tick_busy_loop</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>


    <span class="c1"># Stop Audio</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">stop_stream</span><span class="p">()</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

    <span class="c1"># At this point, we&#39;re done, so we can stop and quit the mixer</span>
    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
    

    <span class="c1"># If the level should be restarted the restart it</span>
    <span class="k">if</span> <span class="n">restart_level</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">start</span><span class="p">()</span></div>




<span class="c1"># Define bandpass filter</span>
<div class="viewcode-block" id="butter_bandpass_filter">
<a class="viewcode-back" href="../../levels.html#levels.twinkle_little_star.butter_bandpass_filter">[docs]</a>
<span class="k">def</span> <span class="nf">butter_bandpass_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply a Butterworth bandpass filter to given one-dimensional data.</span>

<span class="sd">    This function uses a digital bandpass filter design to filter the provided data.</span>
<span class="sd">    The Butterworth filter is a type of signal processing filter designed to have a flat frequency response in the passband.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like</span>
<span class="sd">        The input signal to be filtered.</span>
<span class="sd">    lowcut : float</span>
<span class="sd">        The lower frequency boundary of the passband (Hz).</span>
<span class="sd">    highcut : float</span>
<span class="sd">        The upper frequency boundary of the passband (Hz).</span>
<span class="sd">    sr : int</span>
<span class="sd">        The sampling rate of the data (Hz).</span>
<span class="sd">    order : int, optional</span>
<span class="sd">        The order of the filter. Higher order means a sharper frequency cutoff,</span>
<span class="sd">        but the filter will also be slower to execute. The default is 5.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        The filtered output with the same shape as `data`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sr</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">lowcut</span> <span class="o">/</span> <span class="n">nyquist</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">highcut</span> <span class="o">/</span> <span class="n">nyquist</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="p">[</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;band&#39;</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>


<div class="viewcode-block" id="midi_number_to_pitch">
<a class="viewcode-back" href="../../levels.html#levels.twinkle_little_star.midi_number_to_pitch">[docs]</a>
<span class="k">def</span> <span class="nf">midi_number_to_pitch</span><span class="p">(</span><span class="n">midi_number</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a MIDI note number to its corresponding pitch name with octave.</span>

<span class="sd">    This function utilizes the `music21` library to convert MIDI note numbers into human-readable</span>
<span class="sd">    pitch names, including the octave. The `music21` library&#39;s `Note` object is used to handle the conversion.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    midi_number : int</span>
<span class="sd">        The MIDI number that represents a specific pitch. MIDI numbers range from 0 to 127, </span>
<span class="sd">        where 60 corresponds to Middle C (C4).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The pitch name with octave, as a string. For example, a `midi_number` of 60 will return &#39;C4&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">music21Note</span><span class="o">.</span><span class="n">Note</span><span class="p">()</span>
    <span class="n">n</span><span class="o">.</span><span class="n">pitch</span><span class="o">.</span><span class="n">midi</span> <span class="o">=</span> <span class="n">midi_number</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">pitch</span><span class="o">.</span><span class="n">nameWithOctave</span></div>


<div class="viewcode-block" id="audio_callback">
<a class="viewcode-back" href="../../levels.html#levels.twinkle_little_star.audio_callback">[docs]</a>
<span class="k">def</span> <span class="nf">audio_callback</span><span class="p">(</span><span class="n">in_data</span><span class="p">,</span> <span class="n">frame_count</span><span class="p">,</span> <span class="n">time_info</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A callback function for real-time audio processing, typically used with a PyAudio stream.</span>

<span class="sd">    This function is called by PyAudio whenever new audio data is available. It processes the audio data by applying a bandpass filter, analyzes it </span>
<span class="sd">    to extract pitch information, and then predicts the frequency, confidence, and amplitude. It also handles exceptions by catching them and printing an error message.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    in_data : bytes</span>
<span class="sd">        The buffer of audio data provided by PyAudio.</span>
<span class="sd">    frame_count : int</span>
<span class="sd">        The number of frames in the buffer.</span>
<span class="sd">    time_info : dict</span>
<span class="sd">        A dictionary containing timing information.</span>
<span class="sd">    status : int</span>
<span class="sd">        Status flag indicating if there are any errors or special conditions.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        A tuple containing the original audio data buffer and a flag indicating whether the stream should continue.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">audio_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">in_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>


    <span class="c1"># Apply bandpass filter</span>
    <span class="n">filtered_audio</span> <span class="o">=</span> <span class="n">butter_bandpass_filter</span><span class="p">(</span><span class="n">audio_data</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">7000</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="mi">16000</span><span class="p">)</span>


    <span class="k">try</span><span class="p">:</span>
        <span class="n">time</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="n">crepe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">filtered_audio</span><span class="p">,</span> <span class="mi">16000</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">viterbi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># K.clear_session()</span>
       
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">confidence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">confidence</span><span class="p">)</span>
            <span class="n">freq</span> <span class="o">=</span> <span class="n">frequency</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
            <span class="n">midi_number</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">hz_to_midi</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>

            <span class="k">global</span> <span class="n">main_midi_number_arr</span>
            <span class="n">main_midi_number_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">midi_number</span><span class="p">))</span>
            <span class="n">main_midi_number_arr</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">filtered_audio</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pitch: </span><span class="si">{</span><span class="n">midi_number_to_pitch</span><span class="p">(</span><span class="n">midi_number</span><span class="p">)</span><span class="si">}</span><span class="s2">, Frequency: </span><span class="si">{</span><span class="n">freq</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz, Confidence: </span><span class="si">{</span><span class="n">confidence</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Amplitude: </span><span class="si">{</span><span class="n">amplitude</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing audio: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="k">return</span> <span class="p">(</span><span class="n">in_data</span><span class="p">,</span> <span class="n">pyaudio</span><span class="o">.</span><span class="n">paContinue</span><span class="p">)</span></div>





<div class="viewcode-block" id="create_graph">
<a class="viewcode-back" href="../../levels.html#levels.twinkle_little_star.create_graph">[docs]</a>
<span class="k">def</span> <span class="nf">create_graph</span><span class="p">(</span><span class="n">index_array</span><span class="p">,</span> <span class="n">accuracy_array</span><span class="p">,</span> <span class="n">totnote</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a line graph representing accuracy over a range of indices and saves it as an image.</span>

<span class="sd">    This function uses a subprocess to run a Python script that generates a graph using matplotlib. This method ensures that the creation of the graph does not disrupt the GUI&#39;s window size. The graph is saved to a predefined directory (`assets/images/tempgraphs/`) as `graphy.png`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index_array : list of int</span>
<span class="sd">        A list of indices corresponding to some sequence of measurements or evaluations.</span>
<span class="sd">    accuracy_array : list of float</span>
<span class="sd">        A list of accuracy measurements corresponding to the indices in `index_array`.</span>
<span class="sd">    totnote : int</span>
<span class="sd">        The maximum value on the x-axis, representing the total number of observations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># This creates and saves the graph file using a subprocess so that it doesn&#39;t disrupt the window size</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;python3&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;import matplotlib.pyplot as plt; plt.plot( &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_array</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">accuracy_array</span><span class="p">)</span><span class="o">+</span> <span class="s2">&quot;, color=&#39;orange&#39;, linewidth=5); plt.ylim(0,100); plt.xlim(1,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">totnote</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;); plt.title(&#39;Your overall Accuracy!&#39;); font = {&#39;weight&#39; : &#39;bold&#39;,&#39;size&#39;   : 22}; plt.yticks(fontsize=20); plt.xticks(fontsize=20); plt.rc(&#39;font&#39;, **font); plt.savefig(&#39;assets/images/tempgraphs/graphy.png&#39;); plt.clf()&quot;</span><span class="p">])</span></div>

   

    <span class="c1"># This is the python code to create the graph</span>

    <span class="c1"># plt.plot(index_array,accuracy_array, color=&#39;orange&#39;, linewidth=5)</span>
    <span class="c1"># plt.ylim(0,100)</span>
    <span class="c1"># plt.xlim(1,totnote)</span>
    <span class="c1"># plt.title(&#39;Your overall Accuracy!&#39;)</span>
    
    <span class="c1"># font = {</span>
    <span class="c1">#     &#39;weight&#39; : &#39;bold&#39;,</span>
    <span class="c1">#     &#39;size&#39;   : 22}</span>
    <span class="c1"># plt.yticks(fontsize=20)</span>
    <span class="c1"># plt.xticks(fontsize=20)</span>
    <span class="c1"># plt.rc(&#39;font&#39;, **font)</span>
    <span class="c1"># plt.savefig(&#39;assets/images/tempgraphs/graphy.png&#39;)</span>
    <span class="c1"># plt.clf()</span>


    

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Ben Spence, Jonas Land, AJ Baudino, Hexin Hu, Tripper Wright.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>